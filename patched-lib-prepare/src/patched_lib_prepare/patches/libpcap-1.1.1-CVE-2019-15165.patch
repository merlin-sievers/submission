diff --git a/sf-pcap-ng.c b/sf-pcap-ng.c
index 3535777c..3d0f3542 100644
--- a/sf-pcap-ng.c
+++ b/sf-pcap-ng.c
@@ -102,6 +102,7 @@ struct option_header {
  * Section Header Block.
  */
 #define BT_SHB			0x0A0D0D0A
+#define BT_SHB_INSANE_MAX			1024*1024*1U
 
 struct section_header_block {
 	bpf_u_int32	byte_order_magic;
@@ -583,7 +584,8 @@ pcap_ng_check_header(pcap_t *p, bpf_u_int32 magic, FILE *fp, char *errbuf)
 	/*
 	 * Check the sanity of the total length.
 	 */
-	if (total_length < sizeof(*bhdrp) + sizeof(*shbp) + sizeof(struct block_trailer)) {
+	if (total_length < sizeof(*bhdrp) + sizeof(*shbp) + sizeof(struct block_trailer) ||
+		(total_length > BT_SHB_INSANE_MAX)) {
 		snprintf(errbuf, PCAP_ERRBUF_SIZE,
 		    "Section Header Block in pcap-ng dump file has a length of %u < %lu",
 		    total_length,
