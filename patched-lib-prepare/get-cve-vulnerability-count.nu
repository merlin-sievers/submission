#!/bin/nu

def main [json: path] {
	open $json |
	select product cve_number score paths |
	update paths { |row| $row.paths | split row ", " } |
	flatten paths |
	uniq |
	group-by --to-table product cve_number score |
	update items { |row| $row.items | length } | sort-by items
	# each { |g| {product: $g.product, cve_number: $g.cve_number, count: ($g.items | length) } }
}
